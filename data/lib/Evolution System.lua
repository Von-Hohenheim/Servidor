specialEvo = {
	["Eevee"] = {
		[11444] = "Jolteon",
		[11442] = "Vaporeon",
		[11447] = "Flareon",
		[11452] = "Espeon",
		[11450] = "Umbreon"
	},
	["Poliwhirl"] = 1,
	["Gloom"] = 1,
	["Slowpoke"] = 1,
	["Tyrogue"] = 1
}

evolutionss = {
	{from = "Bulbasaur", to = "Ivysaur", stones = "1 leaf"},
	{from = "Ivysaur", to = "Venusaur", stones = "2 leaf"},
	
	{from = "Squirtle", to = "Wartortle", stones = "1 water"},
	{from = "Wartortle", to = "Blastoise", stones = "2 water"},
	
	{from = "Charmander", to = "Charmeleon", stones = "1 fire"},
	{from = "Charmeleon", to = "Charizard", stones = "2 fire"},
	
	{from = "Caterpie", to = "Metapod", stones = "1 coccon"},
	{from = "Metapod", to = "Butterfree", stones = "2 coccon"},	
	
	
	{from = "Weedle", to = "Kakuna", stones = "1 coccon"},
	{from = "Kakuna", to = "Beedrill", stones = "2 coccon"},	
	
	
	{from = "Pidgey", to = "Pidgeotto", stones = "1 feather"},
	{from = "Pidgeotto", to = "Pidgeot", stones = "2 feather"},		
	
	{from = "Rattata", to = "Raticate", stones = "2 heart"},
	
	{from = "Shiny Rattata", to = "Shiny Raticate", stones = "1 shiny"},	
	
	{from = "Spearow", to = "Fearow", stones = "1 feather"},
	
	{from = "Ekans", to = "Arbok", stones = "2 venom"},		
	
	{from = "Pikachu", to = "Raichu", stones = "2 thunder"},
	
	{from = "Sandshrew", to = "Sandslash", stones = "2 earth"},		
	
	{from = "Nidoran Female", to = "Nidorina", stones = "1 venom"},
	{from = "Nidorina", to = "Nidoqueen", stones = "2 venom"},		
	
	{from = "Nidoran Male", to = "Nidorino", stones = "1 venom"},
	{from = "Nidorino", to = "Nidoking", stones = "2 venom"},		

	{from = "Cleffa", to = "Clefairy", stones = "1 heart"},
	
	{from = "Clefairy", to = "Clefable", stones = "2 heart"},
	
	{from = "Vulpix", to = "Ninetales", stones = "2 fire"},		
	
	{from = "Jigglypuff", to = "Wigglytuff", stones = "2 heart"},
	
	{from = "Zubat", to = "Golbat", stones = "1 venom"},
	
	{from = "Shiny Zubat", to = "Shiny Golbat", stones = "2 shiny"},	

	{from = "Shiny Golbat", to = "Shiny Crobat", stones = "6 shiny"},		
	
	{from = "Cubone", to = "Marowak", stones = "2 earth"},
	
	{from = "Shiny Cubone", to = "Shiny Marowak", stones = "6 shiny"},		
	
	{from = "Koffing", to = "Weezing", stones = "2 venom"},		
	
	{from = "Rhyhorn", to = "Rhydon", stones = "2 rock"},		
	
	{from = "Horsea", to = "Seadra", stones = "1 water"},	
	
	{from = "Shiny Horsea", to = "Shiny Seadra", stones = "2 shiny"},		
	
	{from = "Goldeen", to = "Seaking", stones = "1 water"},		
	
	{from = "Staryu", to = "Starmie", stones = "2 water"},		
	
	{from = "Magikarp", to = "Gyarados", stones = "3 water, 3 crystal"},
	
	{from = "Shiny Magikarp", to = "Shiny Gyarados", stones = "8 shiny"},		
	
	{from = "Dratini", to = "Dragonair", stones = "1 crystal"},	
	
	{from = "Shiny Dratini", to = "Shiny Dragonair", stones = "6 shiny"},	
	
	{from = "Dragonair", to = "Dragonite", stones = "5 crystal"},		
	
	{from = "Tentacool", to = "Tentacruel", stones = "1 water, 1 venom"},
	
	{from = "Shiny Tentacool", to = "Shiny Tentacruel", stones = "7 shiny"},	
	
	{from = "Geodude", to = "Graveler", stones = "1 rock"},	
	
	{from = "Graveler", to = "Golem", stones = "2 rock"},	
	
	{from = "Ponyta", to = "Rapidash", stones = "2 fire"},	
	
	{from = "Magnemite", to = "Magneton", stones = "1 thunder"},	
	
	{from = "Doduo", to = "Dodrio", stones = "1 feather"},	
	
	{from = "Seel", to = "Dewgong", stones = "1 ice, 1 water"},	
	
	{from = "Grimer", to = "Muk", stones = "2 venom"},
	
	{from = "Shiny Grimer", to = "Shiny Muk", stones = "7 shiny"},	
	
	{from = "Shellder", to = "Cloyster", stones = "2 ice"},	
	
	{from = "Gastly", to = "Haunter", stones = "1 dark"},	
	
	{from = "Haunter", to = "Gengar", stones = "2 dark"},	
	
	{from = "Drowzee", to = "Hypno", stones = "2 enigma"},	
	
	{from = "Krabby", to = "Kingler", stones = "1 water"},	
	
	{from = "Shiny Krabby", to = "Shiny Kingler", stones = "5 shiny"},	
	
	{from = "Voltorb", to = "Electrode", stones = "1 thunder"},	
	
	{from = "Shiny Voltorb", to = "Shiny Electrode", stones = "2 shiny"},	
	
	{from = "Exeggcute", to = "Exeggutor", stones = "2 leaf, 2 enigma"},	
	
	{from = "Machop", to = "Machoke", stones = "1 punch"},	
	
	{from = "Machoke", to = "Machamp", stones = "2 punch"},	
	
	{from = "Bellsprout", to = "Weepinbell", stones = "1 leaf"},	
	
	{from = "Weepinbell", to = "Victreebel", stones = "2 leaf"},	
	
	{from = "Growlithe", to = "Arcanine", stones = "5 fire, 1 ancient"},	
	
	{from = "Shiny Growlithe", to = "Shiny Arcanine", stones = "8 shiny"},	
	
	{from = "Poliwag", to = "Poliwhirl", stones = "1 water"},	
	
	{from = "Abra", to = "Kadabra", stones = "1 enigma"},	
	
	{from = "Kadabra", to = "Alakazam", stones = "2 enigma"},	
	
	{from = "Meowth", to = "Persian", stones = "2 heart"},	
	
	{from = "Psyduck", to = "Golduck", stones = "2 water"},	
	
	{from = "Mankey", to = "Primeape", stones = "1 heart"},	
	
	{from = "Venonat", to = "Venomoth", stones = "2 venom"},
	
	{from = "Shiny Venonat", to = "Shiny Venomoth", stones = "5 shiny"},	
	
	{from = "Diglett", to = "Dugtrio", stones = "1 earth"},	
	
	{from = "Oddish", to = "Gloom", stones = "1 leaf"},
	
	{from = "Paras", to = "Parasect", stones = "2 coccon"},
	
	{from = "Shiny Paras", to = "Shiny Parasect", stones = "5 shiny"},	
	
	{from = "Kabuto", to = "Kabutops", stones = "3 rock, 1 ancient"},	
	
	{from = "Omanyte", to = "Omastar", stones = "3 water, 1 ancient"},	
	
	{from = "Onix", to = "Steelix", stones = "1 rock, 1 metal"},

	{from = "Scyther", to = "Scizor", stones = "2 coccon, 1 metal"},
	
	{from = "Chikorita", to = "Bayleef", stones = "1 leaf"},
	
	{from = "Bayleef", to = "Meganium", stones = "2 leaf"},

	{from = "Cyndaquil", to = "Quilava", stones = "1 fire"},	
	
	{from = "Quilava", to = "Typhlosion", stones = "2 fire"},
	
	{from = "Totodile", to = "Croconaw", stones = "1 water"},
	
	{from = "Croconaw", to = "Feraligatr", stones = "2 water"},
	
	{from = "Hoothoot", to = "Noctowl", stones = "2 feather"},
	
	{from = "Ledyba", to = "Ledian", stones = " 2 coccon"},
	
	{from = "Spinarak", to = "Ariados", stones = "2 coccon"},
	
	{from = "Golbat", to = "Crobat", stones = "1 venom, 1 ancient"},
	
	{from = "Chinchou", to = "Lanturn", stones = "1 water, 1 thunder"},
	
	{from = "Pichu", to = "Pikachu", stones = "1 thunder"},
	
	{from = "Igglybuff", to = "Jigglypuff", stones = "1 heart"},
	
	{from = "Jigglypuff", to = "Wigglytuff", stones = "2 heart"},
	
	{from = "Togepi", to = "Togetic", stones = "2 heart"},

	{from = "Natu", to = "Xatu", stones = "1 enigma, 1 feather"},

	{from = "Mareep", to = "Flaaffy", stones = "1 thunder"},
	
	{from = "Flaaffy", to = "Ampharos", stones = "2 thunder"},
	
	{from = "Marill", to = "Azumarill", stones = "2 water"},
	
	{from = "Hoppip", to = "Skiploom", stones = "1 leaf"},	
	
	{from = "Skiploom", to = "Jumpluff", stones = "1 leaf, 1 feather"},		

	{from = "Sunkern", to = "Sunflora", stones = "1 leaf"},	

	{from = "Wooper", to = "Quagsire", stones = "1 water, 1 earth"},
	
	{from = "Pineco", to = "Forretress", stones = "2 coccon"},

	{from = "Snubull", to = "Granbull", stones = "2 heart"},	

	{from = "Teddiursa", to = "Ursaring", stones = "1 heart, 1 ancient"},

	{from = "Slugma", to = "Magcargo", stones = "1 fire, 1 rock"},

	{from = "Swinub", to = "Piloswine", stones = "1 ice, 1 earth"},	

	{from = "Remoraid", to = "Octillery", stones = "2 water"},

	{from = "Houndour", to = "Houndoom", stones = "1 fire, 1 dark"},

	{from = "Seadra", to = "Kingdra", stones = "2 water, 1 ancient"},
	
	{from = "Porygon", to = "Porygon2", stones = "2 enigma"},	
	
	{from = "Elekid", to = "Electabuzz", stones = "2 thunder, 1 ancient"},	
	
	{from = "Magby", to = "Magmar", stones = "2 fire, 1 ancient"},	
	
	{from = "Smoochum", to = "Jynx", stones = "2 ice, 1 ancient"},		
	
	{from = "Chansey", to = "Blissey", stones = "2 heart, 1 ancient"},		
	
	{from = "Larvitar", to = "Pupitar", stones = "1 earth"},

	{from = "Pupitar", to = "Tyranitar", stones = "2 earth, 1 ancient"},	
	
	{from = "Treecko", to = "Grovyle", stones = "1 leaf"},
	{from = "Grovyle", to = "Sceptile", stones = "2 leaf"},
	
	{from = "Mudkip", to = "Marshtomp", stones = "1 water"},
	{from = "Marshtomp", to = "Swampert", stones = "2 water"},
	
	{from = "Torchic", to = "Combusken", stones = "1 fire"},
	{from = "Combusken", to = "Blaziken", stones = "2 fire"},

	{from = "Poochyena", to = "Mightyena", stones = "2 dark, 1 ancient"},
	
	{from = "Zigzagoon", to = "Linoone", stones = "2 heart"},	
	
	{from = "Lotad", to = "Lombre", stones = "1 water"},
	{from = "Lombre", to = "Ludicolo", stones = "1 water, 1 leaf"},	
	
	{from = "Seedot", to = "Nuzleaf", stones = "1 leaf"},
	{from = "Nuzleaf", to = "Shiftry", stones = "1 leaf, 1 dark"},	
	
	{from = "Nincada", to = "Ninjask", stones = "2 coccon, 1 ancient"},	
	
	{from = "Taillow", to = "Swellow", stones = "2 feather"},	
	
	{from = "Shroomish", to = "Breloom", stones = "2 leaf, 1 ancient"},
	
	{from = "Wingull", to = "Pelipper", stones = "1 water, 1 feather"},
	
	{from = "Surskit", to = "Masquerain", stones = "1 coccon, 1 feather"},
	
	{from = "Wailmer", to = "Wailord", stones = "2 water, 2 ancient"},
	
	{from = "Skitty", to = "Delcatty", stones = "2 heart"},
	
	{from = "Baltoy", to = "Claydol", stones = "1 earth, 1 enigma"},

	{from = "Barboach", to = "Whiscash", stones = "1 water, 1 earth"},

	{from = "Corphish", to = "Crawdaunt", stones = "1 water, 1 dark"},

	{from = "Carvanha", to = "Sharpedo", stones = "1 water, 1 dark"},
	
	{from = "Trapinch", to = "Vibrava", stones = "1 earth"},

	{from = "Vibrava", to = "Flygon", stones = "2 earth, 1 ancient"},	
	
	{from = "Makuhita", to = "Hariyama", stones = "2 punch"},	

	{from = "Electrike", to = "Manectric", stones = "2 thunder"},	

	{from = "Numel", to = "Camerupt", stones = "1 fire, 1 earth"},		
	
	{from = "Spheal", to = "Sealeo", stones = "1 water, 1 ice"},	

	{from = "Sealeo", to = "Walrein", stones = "2 water, 1 ancient"},	

	{from = "Cacnea", to = "Cacturn", stones = "2 leaf, 4 ancient"},	

	{from = "Snorunt", to = "Glalie", stones = "2 ice"},
	
	{from = "Azurill", to = "Marill", stones = "1 water"},

	{from = "Spoink", to = "Grumpig", stones = "2 enigma"},	

	{from = "Meditite", to = "Medicham", stones = "1 enigma, 1 punch"},	

	{from = "Swablu", to = "Altaria", stones = "2 crystal, 2 ancient"},	

	{from = "Wynaut", to = "Wobbuffet", stones = "1 enigma, 4 ancient"},	
	
	{from = "Duskull", to = "Dusclops", stones = "2 dark"},
	
	{from = "Slakoth", to = "Vigoroth", stones = "1 heart"},	
	
	{from = "Gulpin", to = "Swalot", stones = "2 venom, 2 ancient"},

	{from = "Whismur", to = "Loudred", stones = "1 heart"},	
	{from = "Loudred", to = "Exploud", stones = "2 heart"},		
	
	{from = "Shuppet", to = "Banette", stones = "2 dark"},

	{from = "Aron", to = "Lairon", stones = "1 rock"},	
	{from = "Lairon", to = "Aggron", stones = "2 rock, 1 metal"},	
	
	{from = "Lileep", to = "Cradily", stones = "2 leaf, 4 ancient"},	

	{from = "Anorith", to = "Armaldo", stones = "2 rock, 4 ancient"},	
	
	{from = "Ralts", to = "Kirlia", stones = "1 enigma"},	
	{from = "Kirlia", to = "Gardevoir", stones = "2 enigma, 4 ancient"},	
	
	{from = "Bagon", to = "Shelgon", stones = "1 crystal"},
	{from = "Beldum", to = "Metang", stones = "1 metal"},	
}

function hasEvolution(name)
	for _, pokeTable in pairs(evolutionss) do
		if pokeTable.from == name then
			return true
		end
	end
	return (specialEvo[name] and true or false)
end

function getPokemonEvolutionTab(name)
	if hasEvolution(name) then
		for _, pokeTable in pairs(evolutionss) do
			if pokeTable.from and pokeTable.from == name then
				return pokeTable
			end
		end
	end
	return {}
end

function getStonesToEvolve(name)
	if hasEvolution(name) then
		local t = getPokemonEvolutionTab(name).stones:explode(",")
		local str = {}
		for _, stones in pairs(t) do
			local t2 = stones:explode(" ")
			table.insert(str, {quant = t2[1], id = stoneToString[t2[2]]})
		end
		return str
	end
	return {}
end

function canEvolveWithThisStone(name, id)
	for _, tab in pairs(getStonesToEvolve(name)) do
		if tab.id == id then
			return true
		end
	end	
	return false
end


function doEvolvePokemon(cid, item2, theevo)
	
	if not isCreature(cid) then return true end
	
	if not pokes[theevo] or not pokes[theevo].offense then
		doReturnPokemon(cid, getPlayerSlotItem(cid, 8), true)
		return true
	end
	
	local owner = getCreatureMaster(item2.uid)
	local pokeball = getPlayerSlotItem(cid, 8)
	
	doItemSetAttribute(pokeball.uid, "poke", theevo)
	doItemSetAttribute(pokeball.uid, "addon", false)
	
	doPlayerSendTextMessage(cid, 20, "Congratulations! Your "..getCreatureName(item2.uid).." evolved into a "..theevo.."!")		
	
	doSendMagicEffect(getThingPos(item2.uid), 18)
	doSendMagicEffect(getThingPos(cid), 173)
	
	local oldpos = getThingPos(item2.uid)
	local oldlod = getCreatureLookDir(item2.uid)
	doRemoveCreature(item2.uid)

	pokeSourceCode = doSummonMonster(cid, theevo)
	
	if not pokeSourceCode then
		doSendMsg(cid, "Erro. Comunique esse codigo ao GM. [31121994]")
		return false
	end
	
	local pk = getCreatureSummons(cid)[1]
	
	if getItemAttribute(pokeball.uid, "nick") and getItemAttribute(pokeball.uid, "nick") ~= "" then
		doCreatureSetNick(pk, nick)
	end
	
	doTeleportThing(pk, oldpos, false)
	doCreatureSetLookDir(pk, oldlod)
	
	sendFinishEvolutionEffect(pk, true)
	addEvent(sendFinishEvolutionEffect, 550, pk, true)
	addEvent(sendFinishEvolutionEffect, 1050, pk)
	
	doAddPokemonInOwnList(cid, theevo)
	doSendPlayerExtendedOpcode(cid, 56,  theevo)
	doTransformItem(pokeball.uid, pokeballs[theevo:lower()].use)
	adjustStatus(pk, pokeball.uid, true, false)
	doUpdateMoves(cid)
	return true
end